# [1] 스테이트풀셋
- App의 인스턴스가 일정한 이름과 상태를 가지며 개별적으로 취급돼야하는 애플리케이션에서 사용
## 1] 스테이트풀셋 스케일링
- 스테이트 풀셋을 스케일 다운하면 항상 가장 높은 서수의 인데스가 먼저 제거(장점: 어떤 pod가 제거될지 알 수 있다)
- 빠른 스케일 다운을 하지 못하기 때문에 스테이트풀셋 한 시점에 하나의 파드인스턴스만 스케일 다운
- 인스턴스 하나라도 비정상인 경우 스케일 다운 허용X

## 2] NFS를 이용한 스테이트풀셋
- nfs 서버: nfs-utils, nfs-utils-lib설치  client서버: showmount 설치
- 퍼시스턴트 스토리지사용(NFS용 기반 디스크(PD) 사용 설정)
	- 지속적 연결을 지원하기 위한 볼륨
	- 파드에 실행중인 에플리케이션이 디스크에 데이터를 유지해야하고 파드가 다른 노드로 재 스케줄링 된 경우에도 동일한 데이터 유지
- 접근모드: RWO, ROX, RWX
- persistentVolumeReclaimPolicy: Retain 기본 정책으로 설정됨
### 1) 거버닝 서비스 생성
	- 헤드리스 서비스를 생성해서 스테이트풀 파드에 네트워크 아이덴티티를 제공하기 위해 사용(clusterIP 필드 None)
	- 파드간의 피어 디스커버리를 사용하기 위해 설정해 둠
### 2) 헤드리스 서비스가 있는 pod 사용(개별 파드와 직접 통신할 목적)
	- 헤드리스 서비스를 생성했으므로 서비스를 통해 파드와 통신X(개별 파드에 직접 연결)
	- 일반적인 서비스를 생성할 수 있으나 개별 파드와 통신하는 허용X
- 워커노드가 장애가 나더라도 즉시 파드가 다른 노드로 재 배포될 수 없음, 반드시 해당 파드가 수동으로 삭제되고 없다는것이 확인되어야 다른 노드로 배포될 수 있음
- 쿠버네티스는 스테이트풀셋에서 새로운 대체 파드를 생성하기 전에 스테이트풀 파드가 더이상 실행 중이지 않음을 확인, 똑같은 두개의 파드가 동시 실행되지 않음을 보장
